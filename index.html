<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Krezus - Inteligentny Bud≈ºet Osobisty</title>
    <link rel="stylesheet" href="src/styles/main.css">
</head>
<body>
    <!-- LOADER -->
    <div id="appLoader" class="app-loader">
        <div class="loader-spinner"></div>
        <p>≈Åadowanie...</p>
    </div>

    <!-- SEKCJA LOGOWANIA -->
    <div id="authSection" class="auth-container hidden">
        <h1 class="text-center" style="color: var(--primary); margin-bottom: 30px;">Krezus üí∞</h1>
        
        <div class="auth-tabs">
            <button class="tab-btn active" onclick="showAuthTab('login')">Logowanie</button>
            <button class="tab-btn" onclick="showAuthTab('register')">Rejestracja</button>
        </div>

        <!-- Formularz logowania -->
        <div id="loginTab" class="tab-content active">
            <form onsubmit="handleLogin(event)">
                <div class="form-group">
                    <label>Email</label>
                    <input type="email" name="loginEmail" required>
                </div>
                <div class="form-group">
                    <label>Has≈Ço</label>
                    <input type="password" name="loginPassword" required>
                </div>
                <button type="submit" class="btn btn-primary" style="width: 100%;">Zaloguj siƒô</button>
            </form>
        </div>

        <!-- Formularz rejestracji -->
        <div id="registerTab" class="tab-content">
            <form onsubmit="handleRegister(event)">
                <div class="form-group">
                    <label>Nazwa u≈ºytkownika</label>
                    <input type="text" name="registerDisplayName" required minlength="2">
                </div>
                <div class="form-group">
                    <label>Email</label>
                    <input type="email" name="registerEmail" required>
                </div>
                <div class="form-group">
                    <label>Has≈Ço (min. 6 znak√≥w)</label>
                    <input type="password" name="registerPassword" required minlength="6">
                </div>
                <button type="submit" class="btn btn-success" style="width: 100%;">Zarejestruj siƒô</button>
            </form>
        </div>
    </div>

    <!-- G≈Å√ìWNA APLIKACJA -->
    <div id="appSection" class="hidden">
        <!-- Nag≈Ç√≥wek -->
        <header class="app-header">
            <div class="header-content">
                <div class="app-title">
                    <h1>Krezus</h1>
                    <span id="appVersion" class="app-version"></span>
                </div>
                <div class="header-user">
                    <div class="user-info">
                        <span id="username"></span>
                    </div>
                    <button class="notification-btn" onclick="openMessages()" title="Wiadomo≈õci">
                        ‚úâÔ∏è
                        <span id="messagesBadge" class="notification-badge" style="display: none;">0</span>
                    </button>
                    <button id="profileBtn" class="btn-profile" onclick="openProfile()">
                        üë§ Profil
                    </button>
                    <button class="btn-logout" onclick="handleLogout()">Wyloguj</button>
                </div>
            </div>
        </header>

        <!-- Nawigacja -->
        <nav class="app-nav">
            <div class="nav-container">
                <div class="nav-menu">
                    <button class="nav-btn active" onclick="showSection('summarySection')">üìä Podsumowanie</button>
                    <button class="nav-btn" onclick="showSection('envelopeSection')">üì© Koperta dnia</button>
                    <button class="nav-btn" onclick="showSection('sourcesSection')">üí∞ Przychody</button>
                    <button class="nav-btn" onclick="showSection('expensesSection')">üí∏ Wydatki</button>
                    <button class="nav-btn" onclick="showSection('categoriesSection')">üè∑Ô∏è Kategorie</button>
                    <button class="nav-btn" onclick="showSection('analyticsSection')">üìà Analityka</button>
                    <button class="nav-btn" onclick="showSection('settingsSection')">‚öôÔ∏è Ustawienia</button>
                </div>
            </div>
        </nav>

        <!-- Container -->
        <div class="container">
            <!-- SEKCJA: Podsumowanie bud≈ºetu -->
            <section id="summarySection" class="section active">
                <div class="section-card">
                    <h2>üí∞ Podsumowanie bud≈ºetu</h2>
                    
                    <div class="stats-grid">
                        <div class="stat-card success">
                            <div class="stat-label">Dostƒôpne ≈õrodki</div>
                            <div class="stat-value">
                                <span id="availableFunds">0.00</span>
                                <span class="stat-unit">z≈Ç</span>
                            </div>
                        </div>
                        <div class="stat-card warning">
                            <div class="stat-label">Cel oszczƒôdno≈õci (rezerwa)</div>
                            <div class="stat-value">
                                <span id="savingGoal">0.00</span>
                                <span class="stat-unit">z≈Ç</span>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-label">Do wydania</div>
                            <div class="stat-value">
                                <span id="toSpend">0.00</span>
                                <span class="stat-unit">z≈Ç</span>
                            </div>
                        </div>
                    </div>

                    <h3>üîÆ Prognozy (z planowanymi)</h3>
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-label">Prognozowane dostƒôpne ≈õrodki</div>
                            <div class="stat-value">
                                <span id="projectedAvailable">0.00</span>
                                <span class="stat-unit">z≈Ç</span>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-label">Prognozowany limit (data 1)</div>
                            <div class="stat-value">
                                <span id="projectedLimit1">0.00</span>
                                <span class="stat-unit">z≈Ç/dzie≈Ñ</span>
                            </div>
                            <div class="stat-label mt-10">Pozosta≈Ço <span id="daysLeft1">0</span> dni</div>
                        </div>
                        <div id="projectedLimit2Section" class="stat-card" style="display: none;">
                            <div class="stat-label">Prognozowany limit (data 2)</div>
                            <div class="stat-value">
                                <span id="projectedLimit2">0.00</span>
                                <span class="stat-unit">z≈Ç/dzie≈Ñ</span>
                            </div>
                            <div class="stat-label mt-10">Pozosta≈Ço <span id="daysLeft2">0</span> dni</div>
                        </div>
                    </div>

                    <h3>üìä Planowane transakcje</h3>
                    <div class="stats-grid">
                        <div class="stat-card success">
                            <div class="stat-label">Planowane przychody</div>
                            <div class="stat-value">
                                <span id="futureIncome">0.00</span>
                                <span class="stat-unit">z≈Ç</span>
                            </div>
                        </div>
                        <div class="stat-card danger">
                            <div class="stat-label">Planowane wydatki</div>
                            <div class="stat-value">
                                <span id="futureExpense">0.00</span>
                                <span class="stat-unit">z≈Ç</span>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- SEKCJA: Koperta dnia -->
            <section id="envelopeSection" class="section">
                <div class="section-card">
                    <h2>üì© Koperta dnia</h2>
                    
                    <div class="envelope-container">
                        <div class="stat-label">Koperta dnia:</div>
                        <div class="envelope-amount">
                            <span id="envelopeAmount">0.00</span> z≈Ç
                        </div>
                        
                        <div class="spending-gauge">
                            <div id="spendingGauge" class="gauge-fill" style="width: 0%"></div>
                        </div>
                        
                        <div class="envelope-details">
                            <div>
                                <strong>Wydano:</strong> <span id="envelopeSpent">0.00</span> z≈Ç
                            </div>
                            <div>
                                <strong>Pozosta≈Ço:</strong> <span id="envelopeRemaining">0.00</span> z≈Ç
                            </div>
                        </div>
                    </div>
                </div>

                <div class="section-card">
                    <h3>üíº Pozosta≈Çe ≈õrodki ze ≈∫r√≥de≈Ç</h3>
                    <div id="sourcesRemainingList"></div>
                </div>
            </section>

            <!-- SEKCJA: ≈πr√≥d≈Ça finans√≥w (Przychody) -->
            <section id="sourcesSection" class="section">
                <div class="section-card">
                    <h2 id="incomeFormTitle">üí∞ Dodaj przych√≥d</h2>
                    <form id="incomeForm" onsubmit="addIncome(event)">
                        <div class="form-row">
                            <div class="form-group">
                                <label>Kwota (z≈Ç)</label>
                                <input type="number" name="incomeAmount" step="0.01" required>
                            </div>
                            <div class="form-group">
                                <label>Typ transakcji</label>
                                <select id="incomeType" name="incomeType" required>
                                    <option value="normal">Zwyk≈Çy</option>
                                    <option value="planned">Planowany</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Data</label>
                                <input type="date" id="incomeDate" name="incomeDate" required>
                            </div>
                            <div class="form-group" id="incomeTimeGroup">
                                <label>Godzina (opcjonalnie)</label>
                                <input type="time" id="incomeTime" name="incomeTime">
                            </div>
                        </div>
                        <div class="form-group">
                            <label>≈πr√≥d≈Ço</label>
                            <input type="text" name="incomeSource" placeholder="np. Wynagrodzenie, Premia">
                        </div>
                        <div class="form-group">
                            <label>Opis (opcjonalnie)</label>
                            <input type="text" name="incomeDescription" placeholder="Dodatkowe informacje">
                        </div>
                        <button type="submit" class="btn btn-success mt-20">Zapisz przych√≥d</button>
                    </form>
                </div>

                <div class="section-card">
                    <h3>üìã Historia przychod√≥w</h3>
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th>Data</th>
                                    <th>Godzina</th>
                                    <th>Kwota</th>
                                    <th>≈πr√≥d≈Ço</th>
                                    <th>Opis</th>
                                    <th>Typ</th>
                                    <th>Akcje</th>
                                </tr>
                            </thead>
                            <tbody id="sourcesTableBody">
                                <tr><td colspan="7" class="empty-state">Brak przychod√≥w do wy≈õwietlenia</td></tr>
                            </tbody>
                        </table>
                    </div>
                    <div class="pagination-container">
                        <div id="incomesPagination"></div>
                    </div>
                </div>
            </section>

            <!-- SEKCJA: Wydatki -->
            <section id="expensesSection" class="section">
                <div class="section-card">
                    <h2 id="expenseFormTitle">üí∏ Dodaj wydatek</h2>
                    <form id="expenseForm" onsubmit="addExpense(event)">
                        <div class="form-row">
                            <div class="form-group">
                                <label>Kwota (z≈Ç)</label>
                                <input type="number" name="expenseAmount" step="0.01" required>
                            </div>
                            <div class="form-group">
                                <label>Typ transakcji</label>
                                <select id="expenseType" name="expenseType" required>
                                    <option value="normal">Zwyk≈Çy</option>
                                    <option value="planned">Planowany</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Data</label>
                                <input type="date" id="expenseDate" name="expenseDate" required>
                            </div>
                            <div class="form-group" id="expenseTimeGroup">
                                <label>Godzina (opcjonalnie)</label>
                                <input type="time" id="expenseTime" name="expenseTime">
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Kategoria</label>
                                <select id="expenseCategory" name="expenseCategory" required>
                                    <option value="">Wybierz kategoriƒô</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>≈πr√≥d≈Ço</label>
                                <input type="text" name="expenseSource" placeholder="SkƒÖd wziƒôto ≈õrodki">
                            </div>
                        </div>
                        <div class="form-group">
                            <label>Opis</label>
                            <input type="text" name="expenseDescription" placeholder="Na co wydano">
                        </div>
                        <button type="submit" class="btn btn-primary mt-20">Zapisz wydatek</button>
                    </form>
                </div>

                <div class="section-card">
                    <h3>üìã Historia wydatk√≥w</h3>
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th>Data</th>
                                    <th>Godzina</th>
                                    <th>Kwota</th>
                                    <th>Kategoria</th>
                                    <th>Opis</th>
                                    <th>≈πr√≥d≈Ço</th>
                                    <th>Typ</th>
                                    <th>Akcje</th>
                                </tr>
                            </thead>
                            <tbody id="expensesTableBody">
                                <tr><td colspan="8" class="empty-state">Brak wydatk√≥w do wy≈õwietlenia</td></tr>
                            </tbody>
                        </table>
                    </div>
                    <div class="pagination-container">
                        <div id="expensesPagination"></div>
                    </div>
                </div>
            </section>

            <!-- SEKCJA: Kategorie -->
            <section id="categoriesSection" class="section">
                <div class="section-card">
                    <h2>üè∑Ô∏è ZarzƒÖdzaj kategoriami</h2>
                    
                    <div class="form-group">
                        <label>Nowa kategoria</label>
                        <div style="display: flex; gap: 10px;">
                            <input type="text" id="newCategoryName" placeholder="Nazwa kategorii" style="flex: 1;">
                            <button class="btn btn-success" onclick="addCategory()">Dodaj</button>
                        </div>
                    </div>

                    <div class="mt-20">
                        <h3>üìã Lista kategorii</h3>
                        <div id="categoriesList"></div>
                    </div>
                </div>
            </section>

            <!-- SEKCJA: Analityka -->
            <section id="analyticsSection" class="section">
                <div class="section-card">
                    <h2>üìà Analiza wydatk√≥w</h2>
                    
                    <!-- Wyb√≥r okresu -->
                    <div class="analytics-controls">
                        <div class="form-group">
                            <label>Wybierz okres</label>
                            <div class="period-buttons">
                                <button class="period-btn active" onclick="selectPeriod(7)">7 dni</button>
                                <button class="period-btn" onclick="selectPeriod(14)">14 dni</button>
                                <button class="period-btn" onclick="selectPeriod(30)">30 dni</button>
                                <button class="period-btn" onclick="selectPeriod(90)">90 dni</button>
                                <button class="period-btn" onclick="selectPeriod('custom')">W≈Çasny</button>
                            </div>
                        </div>
                        
                        <div id="customPeriodInputs" class="custom-period" style="display: none;">
                            <div class="form-row">
                                <div class="form-group">
                                    <label>Data od</label>
                                    <input type="date" id="analyticsDateFrom">
                                </div>
                                <div class="form-group">
                                    <label>Data do</label>
                                    <input type="date" id="analyticsDateTo">
                                </div>
                                <div class="form-group" style="display: flex; align-items: flex-end;">
                                    <button class="btn btn-primary" onclick="applyCustomPeriod()">Zastosuj</button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Statystyki okresu -->
                    <h3>üìä Podsumowanie okresu</h3>
                    <div class="stats-grid">
                        <div class="stat-card danger">
                            <div class="stat-label">Wydatki w okresie</div>
                            <div class="stat-value">
                                <span id="periodExpenses">0.00</span>
                                <span class="stat-unit">z≈Ç</span>
                            </div>
                        </div>
                        <div class="stat-card success">
                            <div class="stat-label">Przychody w okresie</div>
                            <div class="stat-value">
                                <span id="periodIncomes">0.00</span>
                                <span class="stat-unit">z≈Ç</span>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-label">Liczba transakcji</div>
                            <div class="stat-value">
                                <span id="periodTransactions">0</span>
                            </div>
                        </div>
                    </div>

                    <!-- Por√≥wnanie z poprzednim okresem -->
                    <h3>üîÑ Por√≥wnanie z poprzednim okresem</h3>
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-label">Zmiana wydatk√≥w</div>
                            <div class="stat-value">
                                <span id="expenseChange">0.0%</span>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-label">Zmiana przychod√≥w</div>
                            <div class="stat-value">
                                <span id="incomeChange">0.0%</span>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-label">Zmiana liczby transakcji</div>
                            <div class="stat-value">
                                <span id="transactionChange">0.0%</span>
                            </div>
                        </div>
                    </div>

                    <!-- Top kategorie -->
                    <h3>üèÜ Najkosztowniejsza kategoria</h3>
                    <div id="mostExpensiveCategory"></div>

                    <h3>üìä Udzia≈Ç kategorii w wydatkach</h3>
                    <div id="categoriesBreakdown"></div>

                    <!-- Anomalie -->
                    <h3>‚ö†Ô∏è Wykryte anomalie</h3>
                    <div id="anomaliesList"></div>
                </div>
            </section>

            <!-- SEKCJA: Ustawienia -->
            <section id="settingsSection" class="section">
                <div class="section-card">
                    <h2>‚öôÔ∏è Ustawienia bud≈ºetu</h2>
                    
                    <form onsubmit="saveSettings(event)">
                        <div class="form-group">
                            <label>Data ko≈Ñcowa okresu 1 (g≈Ç√≥wny okres)</label>
                            <input type="date" name="endDate1" required>
                        </div>
                        <div class="form-group">
                            <label>Data ko≈Ñcowa okresu 2 (opcjonalnie)</label>
                            <input type="date" name="endDate2">
                            <small class="text-muted">Pozostaw puste je≈õli chcesz u≈ºywaƒá tylko jednego okresu</small>
                        </div>
                        <div class="form-group">
                            <label>Cel oszczƒôdno≈õci / Rezerwa (z≈Ç)</label>
                            <input type="number" name="savingGoal" step="0.01" min="0" value="0">
                            <small class="text-muted">Kwota kt√≥ra zostanie odjƒôta od dostƒôpnych ≈õrodk√≥w</small>
                        </div>
                        <button type="submit" class="btn btn-primary">Zapisz ustawienia</button>
                    </form>
                </div>
            </section>
        </div>
    </div>

    <!-- Skrypty -->
    <script type="module" src="src/app.js"></script>
    
    <script>
        // Prze≈ÇƒÖczanie tab√≥w autoryzacji
        function showAuthTab(tab) {
            document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            
            if (tab === 'login') {
                document.querySelector('.tab-btn:first-child').classList.add('active');
                document.getElementById('loginTab').classList.add('active');
            } else {
                document.querySelector('.tab-btn:last-child').classList.add('active');
                document.getElementById('registerTab').classList.add('active');
            }
        }
    </script>
</body>
</html>